<!doctype html>
<html>
<head>
<title>/Users/Lily/csp_teamwork_iphone/teamwork/teamwork/app/widget/addPhoto/QBImagePickerController/QBImagePickerController.m</title>
<style type="text/css">
 body { color:#000000; background-color:#ffffff }
 body { font-family:Helvetica, sans-serif; font-size:10pt }
 h1 { font-size:14pt }
 .code { border-collapse:collapse; width:100%; }
 .code { font-family: "Monospace", monospace; font-size:10pt }
 .code { line-height: 1.2em }
 .comment { color: green; font-style: oblique }
 .keyword { color: blue }
 .string_literal { color: red }
 .directive { color: darkmagenta }
 .expansion { display: none; }
 .macro:hover .expansion { display: block; border: 2px solid #FF0000; padding: 2px; background-color:#FFF0F0; font-weight: normal;   -webkit-border-radius:5px;  -webkit-box-shadow:1px 1px 7px #000;   border-radius:5px;  box-shadow:1px 1px 7px #000; position: absolute; top: -1em; left:10em; z-index: 1 } 
 .macro { color: darkmagenta; background-color:LemonChiffon; position: relative }
 .num { width:2.5em; padding-right:2ex; background-color:#eeeeee }
 .num { text-align:right; font-size:8pt }
 .num { color:#444444 }
 .line { padding-left: 1ex; border-left: 3px solid #ccc }
 .line { white-space: pre }
 .msg { -webkit-box-shadow:1px 1px 7px #000 }
 .msg { box-shadow:1px 1px 7px #000 }
 .msg { -webkit-border-radius:5px }
 .msg { border-radius:5px }
 .msg { font-family:Helvetica, sans-serif; font-size:8pt }
 .msg { float:left }
 .msg { padding:0.25em 1ex 0.25em 1ex }
 .msg { margin-top:10px; margin-bottom:10px }
 .msg { font-weight:bold }
 .msg { max-width:60em; word-wrap: break-word; white-space: pre-wrap }
 .msgT { padding:0x; spacing:0x }
 .msgEvent { background-color:#fff8b4; color:#000000 }
 .msgControl { background-color:#bbbbbb; color:#000000 }
 .msgNote { background-color:#ddeeff; color:#000000 }
 .mrange { background-color:#dfddf3 }
 .mrange { border-bottom:1px solid #6F9DBE }
 .PathIndex { font-weight: bold; padding:0px 5px; margin-right:5px; }
 .PathIndex { -webkit-border-radius:8px }
 .PathIndex { border-radius:8px }
 .PathIndexEvent { background-color:#bfba87 }
 .PathIndexControl { background-color:#8c8c8c }
 .PathNav a { text-decoration:none; font-size: larger }
 .CodeInsertionHint { font-weight: bold; background-color: #10dd10 }
 .CodeRemovalHint { background-color:#de1010 }
 .CodeRemovalHint { border-bottom:1px solid #6F9DBE }
 table.simpletable {
   padding: 5px;
   font-size:12pt;
   margin:20px;
   border-collapse: collapse; border-spacing: 0px;
 }
 td.rowname {
   text-align: right;
   vertical-align: top;
   font-weight: bold;
   color:#444444;
   padding-right:2ex;
 }
</style>
</head>
<body>
<!-- BUGDESC Value stored to 'top' is never read -->

<!-- BUGTYPE Dead increment -->

<!-- BUGCATEGORY Dead store -->

<!-- BUGFILE /Users/Lily/csp_teamwork_iphone/teamwork/teamwork/app/widget/addPhoto/QBImagePickerController/QBImagePickerController.m -->

<!-- FILENAME QBImagePickerController.m -->

<!-- FUNCTIONNAME viewWillAppear: -->

<!-- ISSUEHASHCONTENTOFLINEINCONTEXT 3a23e55b7f443bdfcc3e0a6770fbaae6 -->

<!-- BUGLINE 211 -->

<!-- BUGCOLUMN 65 -->

<!-- BUGPATHLENGTH 1 -->

<!-- BUGMETAEND -->
<!-- REPORTHEADER -->
<h3>Bug Summary</h3>
<table class="simpletable">
<tr><td class="rowname">File:</td><td>app/widget/addPhoto/QBImagePickerController/QBImagePickerController.m</td></tr>
<tr><td class="rowname">Warning:</td><td><a href="#EndPath">line 211, column 65</a><br />Value stored to 'top' is never read</td></tr>
</table>
<!-- REPORTSUMMARYEXTRA -->
<h3>Annotated Source Code</h3>
<table class="code">
<tr><td class="num" id="LN1">1</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr><td class="num" id="LN2">2</td><td class="line"> <span class='comment'>Copyright (c) 2013 Katsuma Tanaka</span></td></tr>
<tr><td class="num" id="LN3">3</td><td class="line"> </td></tr>
<tr><td class="num" id="LN4">4</td><td class="line"> <span class='comment'>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</span></td></tr>
<tr><td class="num" id="LN5">5</td><td class="line"> </td></tr>
<tr><td class="num" id="LN6">6</td><td class="line"> <span class='comment'>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</span></td></tr>
<tr><td class="num" id="LN7">7</td><td class="line"> </td></tr>
<tr><td class="num" id="LN8">8</td><td class="line"> <span class='comment'>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span></td></tr>
<tr><td class="num" id="LN9">9</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr><td class="num" id="LN10">10</td><td class="line"> </td></tr>
<tr><td class="num" id="LN11">11</td><td class="line"><span class='directive'>#import "QBImagePickerController.h"</span></td></tr>
<tr><td class="num" id="LN12">12</td><td class="line"> </td></tr>
<tr><td class="num" id="LN13">13</td><td class="line"><span class='comment'>// Views</span></td></tr>
<tr><td class="num" id="LN14">14</td><td class="line"><span class='directive'>#import "QBImagePickerGroupCell.h"</span></td></tr>
<tr><td class="num" id="LN15">15</td><td class="line"> </td></tr>
<tr><td class="num" id="LN16">16</td><td class="line"><span class='comment'>// Controllers</span></td></tr>
<tr><td class="num" id="LN17">17</td><td class="line"><span class='directive'>#import "QBAssetCollectionViewController.h"</span></td></tr>
<tr><td class="num" id="LN18">18</td><td class="line"><span class='directive'>#import "TWAppDelegate.h"</span></td></tr>
<tr><td class="num" id="LN19">19</td><td class="line"> </td></tr>
<tr><td class="num" id="LN20">20</td><td class="line">@interface QBImagePickerController ()</td></tr>
<tr><td class="num" id="LN21">21</td><td class="line"> </td></tr>
<tr><td class="num" id="LN22">22</td><td class="line">@property (nonatomic, strong) ALAssetsLibrary *assetsLibrary;</td></tr>
<tr><td class="num" id="LN23">23</td><td class="line">@property (nonatomic, strong) NSMutableArray *assetsGroups;</td></tr>
<tr><td class="num" id="LN24">24</td><td class="line"> </td></tr>
<tr><td class="num" id="LN25">25</td><td class="line">@property (nonatomic, strong) UITableView *tableView;</td></tr>
<tr><td class="num" id="LN26">26</td><td class="line"> </td></tr>
<tr><td class="num" id="LN27">27</td><td class="line">@property (nonatomic, assign) UIBarStyle previousBarStyle;</td></tr>
<tr><td class="num" id="LN28">28</td><td class="line">@property (nonatomic, assign) BOOL previousBarTranslucent;</td></tr>
<tr><td class="num" id="LN29">29</td><td class="line">@property (nonatomic, assign) UIStatusBarStyle previousStatusBarStyle;</td></tr>
<tr><td class="num" id="LN30">30</td><td class="line"> </td></tr>
<tr><td class="num" id="LN31">31</td><td class="line">- (<span class='keyword'>void</span>)cancel;</td></tr>
<tr><td class="num" id="LN32">32</td><td class="line">- (NSDictionary *)mediaInfoFromAsset:(ALAsset *)asset;</td></tr>
<tr><td class="num" id="LN33">33</td><td class="line"> </td></tr>
<tr><td class="num" id="LN34">34</td><td class="line">@end</td></tr>
<tr><td class="num" id="LN35">35</td><td class="line"> </td></tr>
<tr><td class="num" id="LN36">36</td><td class="line">@implementation QBImagePickerController</td></tr>
<tr><td class="num" id="LN37">37</td><td class="line"> </td></tr>
<tr><td class="num" id="LN38">38</td><td class="line">- (<span class='keyword'>void</span>)dealloc</td></tr>
<tr><td class="num" id="LN39">39</td><td class="line">{</td></tr>
<tr><td class="num" id="LN40">40</td><td class="line">    [[NSNotificationCenter defaultCenter] removeObserver:self];</td></tr>
<tr><td class="num" id="LN41">41</td><td class="line">}</td></tr>
<tr><td class="num" id="LN42">42</td><td class="line"> </td></tr>
<tr><td class="num" id="LN43">43</td><td class="line">- (instancetype)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil</td></tr>
<tr><td class="num" id="LN44">44</td><td class="line">{</td></tr>
<tr><td class="num" id="LN45">45</td><td class="line">    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];</td></tr>
<tr><td class="num" id="LN46">46</td><td class="line">    </td></tr>
<tr><td class="num" id="LN47">47</td><td class="line">    <span class='keyword'>if</span> (self) {</td></tr>
<tr><td class="num" id="LN48">48</td><td class="line">        <span class='keyword'>if</span> (<span class='macro'>IOS7_OR_LATER<span class='expansion'>( [[[UIDevice currentDevice] systemVersion] compare:@"7.0"] !=<br> NSOrderedAscending )</span></span>)</td></tr>
<tr><td class="num" id="LN49">49</td><td class="line">        {</td></tr>
<tr><td class="num" id="LN50">50</td><td class="line">            [[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleLightContent];</td></tr>
<tr><td class="num" id="LN51">51</td><td class="line">            [self setNeedsStatusBarAppearanceUpdate];</td></tr>
<tr><td class="num" id="LN52">52</td><td class="line">        }</td></tr>
<tr><td class="num" id="LN53">53</td><td class="line"> </td></tr>
<tr><td class="num" id="LN54">54</td><td class="line">        <span class='comment'>/* Check sources */</span></td></tr>
<tr><td class="num" id="LN55">55</td><td class="line">        [UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera];</td></tr>
<tr><td class="num" id="LN56">56</td><td class="line">        [UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypePhotoLibrary];</td></tr>
<tr><td class="num" id="LN57">57</td><td class="line">        [UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeSavedPhotosAlbum];</td></tr>
<tr><td class="num" id="LN58">58</td><td class="line">        </td></tr>
<tr><td class="num" id="LN59">59</td><td class="line">        <span class='comment'>/* Initialization */</span></td></tr>
<tr><td class="num" id="LN60">60</td><td class="line">        self.title = @<span class='string_literal'>"相册"</span>;</td></tr>
<tr><td class="num" id="LN61">61</td><td class="line">        self.filterType = QBImagePickerFilterTypeAllPhotos;</td></tr>
<tr><td class="num" id="LN62">62</td><td class="line">        self.showsCancelButton = <span class='macro'>YES<span class='expansion'>__objc_yes</span></span>;</td></tr>
<tr><td class="num" id="LN63">63</td><td class="line">        self.fullScreenLayoutEnabled = <span class='macro'>YES<span class='expansion'>__objc_yes</span></span>;</td></tr>
<tr><td class="num" id="LN64">64</td><td class="line">        </td></tr>
<tr><td class="num" id="LN65">65</td><td class="line">        self.allowsMultipleSelection = <span class='macro'>NO<span class='expansion'>__objc_no</span></span>;</td></tr>
<tr><td class="num" id="LN66">66</td><td class="line">        self.limitsMinimumNumberOfSelection = <span class='macro'>NO<span class='expansion'>__objc_no</span></span>;</td></tr>
<tr><td class="num" id="LN67">67</td><td class="line">        self.limitsMaximumNumberOfSelection = <span class='macro'>NO<span class='expansion'>__objc_no</span></span>;</td></tr>
<tr><td class="num" id="LN68">68</td><td class="line">        self.minimumNumberOfSelection = 0;</td></tr>
<tr><td class="num" id="LN69">69</td><td class="line">        self.maximumNumberOfSelection = 0;</td></tr>
<tr><td class="num" id="LN70">70</td><td class="line">        </td></tr>
<tr><td class="num" id="LN71">71</td><td class="line">        ALAssetsLibrary *assetsLibrary = [[ALAssetsLibrary alloc] init];</td></tr>
<tr><td class="num" id="LN72">72</td><td class="line">        self.assetsLibrary = assetsLibrary;</td></tr>
<tr><td class="num" id="LN73">73</td><td class="line">        </td></tr>
<tr><td class="num" id="LN74">74</td><td class="line">        self.assetsGroups = [NSMutableArray array];</td></tr>
<tr><td class="num" id="LN75">75</td><td class="line">        </td></tr>
<tr><td class="num" id="LN76">76</td><td class="line">        <span class='comment'>// 顶部导航视图</span></td></tr>
<tr><td class="num" id="LN77">77</td><td class="line">        UIView *navigationView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 62)];</td></tr>
<tr><td class="num" id="LN78">78</td><td class="line">        navigationView.backgroundColor = [UIColor colorWithString:<span class='macro'>MainColorStyle<span class='expansion'>@"#00bbd2"</span></span>];<span class='comment'>//[UIColor colorWithRed:248/255.0 green:248/255.0 blue:248/255.0 alpha:1];</span></td></tr>
<tr><td class="num" id="LN79">79</td><td class="line">        [self.view addSubview:navigationView];</td></tr>
<tr><td class="num" id="LN80">80</td><td class="line">        </td></tr>
<tr><td class="num" id="LN81">81</td><td class="line">        <span class='comment'>// 返回按钮</span></td></tr>
<tr><td class="num" id="LN82">82</td><td class="line">        UIButton *backButton = [UIButton buttonWithType:UIButtonTypeCustom];</td></tr>
<tr><td class="num" id="LN83">83</td><td class="line">        [backButton setImage:[UIImage imageNamed:@<span class='string_literal'>"tw_return_normal.png"</span>] forState:UIControlStateNormal];</td></tr>
<tr><td class="num" id="LN84">84</td><td class="line">        [backButton setImage:[UIImage imageNamed:@<span class='string_literal'>"tw_return_current.png"</span>] forState:UIControlStateHighlighted];</td></tr>
<tr><td class="num" id="LN85">85</td><td class="line">        backButton.frame = CGRectMake(0, 22, 40, 40);</td></tr>
<tr><td class="num" id="LN86">86</td><td class="line">        [backButton addTarget:self action:@selector(back:) forControlEvents:UIControlEventTouchUpInside];</td></tr>
<tr><td class="num" id="LN87">87</td><td class="line">        [navigationView addSubview:backButton];</td></tr>
<tr><td class="num" id="LN88">88</td><td class="line">        </td></tr>
<tr><td class="num" id="LN89">89</td><td class="line">        UILabel *navigatTitle = [[UILabel alloc] initWithFrame:CGRectMake(120, 22, 80, 40)];</td></tr>
<tr><td class="num" id="LN90">90</td><td class="line">        navigatTitle.backgroundColor = [UIColor clearColor];</td></tr>
<tr><td class="num" id="LN91">91</td><td class="line">        navigatTitle.textAlignment = NSTextAlignmentCenter;</td></tr>
<tr><td class="num" id="LN92">92</td><td class="line">        navigatTitle.font = [UIFont boldSystemFontOfSize:16.0f];</td></tr>
<tr><td class="num" id="LN93">93</td><td class="line">        navigatTitle.text = @<span class='string_literal'>"本地相册"</span>;</td></tr>
<tr><td class="num" id="LN94">94</td><td class="line">        navigatTitle.textColor = [UIColor whiteColor];<span class='comment'>//[UIColor colorWithRed:1/255.0 green:1/255.0 blue:1/255.0 alpha:1];</span></td></tr>
<tr><td class="num" id="LN95">95</td><td class="line">        [navigationView addSubview:navigatTitle];</td></tr>
<tr><td class="num" id="LN96">96</td><td class="line">        </td></tr>
<tr><td class="num" id="LN97">97</td><td class="line">        UILabel *bottom = [[UILabel alloc] initWithFrame:CGRectMake(0, navigationView.frame.size.height - 0.6, navigationView.frame.size.width, 0.6)];</td></tr>
<tr><td class="num" id="LN98">98</td><td class="line">        bottom.backgroundColor = [UIColor colorWithRed:160/255.0 green:160/255.0 blue:160/255.0 alpha:1];</td></tr>
<tr><td class="num" id="LN99">99</td><td class="line">        [navigationView addSubview:bottom];</td></tr>
<tr><td class="num" id="LN100">100</td><td class="line">        </td></tr>
<tr><td class="num" id="LN101">101</td><td class="line">        <span class='comment'>// Table View</span></td></tr>
<tr><td class="num" id="LN102">102</td><td class="line">        UITableView *tableView = [[UITableView alloc] initWithFrame:CGRectMake(0, navigationView.frame.size.height, self.view.bounds.size.width, self.view.bounds.size.height - navigationView.frame.size.height) style:UITableViewStylePlain];</td></tr>
<tr><td class="num" id="LN103">103</td><td class="line">        tableView.separatorStyle = UITableViewCellSeparatorStyleNone;</td></tr>
<tr><td class="num" id="LN104">104</td><td class="line">        tableView.dataSource = self;</td></tr>
<tr><td class="num" id="LN105">105</td><td class="line">        tableView.delegate = self;</td></tr>
<tr><td class="num" id="LN106">106</td><td class="line">        tableView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;</td></tr>
<tr><td class="num" id="LN107">107</td><td class="line">        [self.view addSubview:tableView];</td></tr>
<tr><td class="num" id="LN108">108</td><td class="line">        self.tableView = tableView;</td></tr>
<tr><td class="num" id="LN109">109</td><td class="line"> </td></tr>
<tr><td class="num" id="LN110">110</td><td class="line">        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(reloadData)</td></tr>
<tr><td class="num" id="LN111">111</td><td class="line">                                                     name:UIApplicationWillEnterForegroundNotification object:<span class='macro'>nil<span class='expansion'>((void *)0)</span></span>];</td></tr>
<tr><td class="num" id="LN112">112</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN113">113</td><td class="line">    </td></tr>
<tr><td class="num" id="LN114">114</td><td class="line">    <span class='keyword'>return</span> self;</td></tr>
<tr><td class="num" id="LN115">115</td><td class="line">}</td></tr>
<tr><td class="num" id="LN116">116</td><td class="line"> </td></tr>
<tr><td class="num" id="LN117">117</td><td class="line">- (<span class='keyword'>void</span>)back:(id)sender {</td></tr>
<tr><td class="num" id="LN118">118</td><td class="line">    </td></tr>
<tr><td class="num" id="LN119">119</td><td class="line">    [self dismissViewControllerAnimated:<span class='macro'>YES<span class='expansion'>__objc_yes</span></span> completion:^{</td></tr>
<tr><td class="num" id="LN120">120</td><td class="line">        <span class='keyword'>if</span> (_delegate &amp;&amp; [_delegate respondsToSelector:@selector(dismissViewControllerAnimated)])</td></tr>
<tr><td class="num" id="LN121">121</td><td class="line">        {</td></tr>
<tr><td class="num" id="LN122">122</td><td class="line">            [_delegate dismissViewControllerAnimated];</td></tr>
<tr><td class="num" id="LN123">123</td><td class="line">        }</td></tr>
<tr><td class="num" id="LN124">124</td><td class="line">    }];</td></tr>
<tr><td class="num" id="LN125">125</td><td class="line">}</td></tr>
<tr><td class="num" id="LN126">126</td><td class="line">- (<span class='keyword'>void</span>)viewDidLoad</td></tr>
<tr><td class="num" id="LN127">127</td><td class="line">{</td></tr>
<tr><td class="num" id="LN128">128</td><td class="line">    [super viewDidLoad];</td></tr>
<tr><td class="num" id="LN129">129</td><td class="line">    [self reloadData];</td></tr>
<tr><td class="num" id="LN130">130</td><td class="line">}</td></tr>
<tr><td class="num" id="LN131">131</td><td class="line"> </td></tr>
<tr><td class="num" id="LN132">132</td><td class="line">- (<span class='keyword'>void</span>)reloadData</td></tr>
<tr><td class="num" id="LN133">133</td><td class="line">{</td></tr>
<tr><td class="num" id="LN134">134</td><td class="line">    [self.assetsGroups removeAllObjects];</td></tr>
<tr><td class="num" id="LN135">135</td><td class="line">    <span class='keyword'>void</span> (^assetsGroupsEnumerationBlock)(ALAssetsGroup *, BOOL *) = ^(ALAssetsGroup *assetsGroup, BOOL *stop) {</td></tr>
<tr><td class="num" id="LN136">136</td><td class="line">        <span class='keyword'>if</span> (assetsGroup) {</td></tr>
<tr><td class="num" id="LN137">137</td><td class="line">            <span class='keyword'>switch</span>(self.filterType) {</td></tr>
<tr><td class="num" id="LN138">138</td><td class="line">                <span class='keyword'>case</span> QBImagePickerFilterTypeAllAssets:</td></tr>
<tr><td class="num" id="LN139">139</td><td class="line">                    [assetsGroup setAssetsFilter:[ALAssetsFilter allAssets]];</td></tr>
<tr><td class="num" id="LN140">140</td><td class="line">                    <span class='keyword'>break</span>;</td></tr>
<tr><td class="num" id="LN141">141</td><td class="line">                <span class='keyword'>case</span> QBImagePickerFilterTypeAllPhotos:</td></tr>
<tr><td class="num" id="LN142">142</td><td class="line">                    [assetsGroup setAssetsFilter:[ALAssetsFilter allPhotos]];</td></tr>
<tr><td class="num" id="LN143">143</td><td class="line">                    <span class='keyword'>break</span>;</td></tr>
<tr><td class="num" id="LN144">144</td><td class="line">                <span class='keyword'>case</span> QBImagePickerFilterTypeAllVideos:</td></tr>
<tr><td class="num" id="LN145">145</td><td class="line">                    [assetsGroup setAssetsFilter:[ALAssetsFilter allVideos]];</td></tr>
<tr><td class="num" id="LN146">146</td><td class="line">                    <span class='keyword'>break</span>;</td></tr>
<tr><td class="num" id="LN147">147</td><td class="line">            }</td></tr>
<tr><td class="num" id="LN148">148</td><td class="line"> </td></tr>
<tr><td class="num" id="LN149">149</td><td class="line">            <span class='keyword'>if</span> (assetsGroup.numberOfAssets &gt; 0) {</td></tr>
<tr><td class="num" id="LN150">150</td><td class="line">                [self.assetsGroups addObject:assetsGroup];</td></tr>
<tr><td class="num" id="LN151">151</td><td class="line">                [self.tableView reloadData];</td></tr>
<tr><td class="num" id="LN152">152</td><td class="line">            }</td></tr>
<tr><td class="num" id="LN153">153</td><td class="line">            <span class='comment'>//直接导入下一层</span></td></tr>
<tr><td class="num" id="LN154">154</td><td class="line">            <span class='keyword'>if</span> (self.assetsGroups.count &gt; 0) {</td></tr>
<tr><td class="num" id="LN155">155</td><td class="line">                [self nextView];</td></tr>
<tr><td class="num" id="LN156">156</td><td class="line">            }</td></tr>
<tr><td class="num" id="LN157">157</td><td class="line">        }</td></tr>
<tr><td class="num" id="LN158">158</td><td class="line">    };</td></tr>
<tr><td class="num" id="LN159">159</td><td class="line"> </td></tr>
<tr><td class="num" id="LN160">160</td><td class="line">    <span class='keyword'>void</span> (^assetsGroupsFailureBlock)(NSError *) = ^(NSError *error) {</td></tr>
<tr><td class="num" id="LN161">161</td><td class="line">        NSLog(@<span class='string_literal'>"Error: %@"</span>, [error localizedDescription]);</td></tr>
<tr><td class="num" id="LN162">162</td><td class="line">    };</td></tr>
<tr><td class="num" id="LN163">163</td><td class="line"> </td></tr>
<tr><td class="num" id="LN164">164</td><td class="line">    <span class='comment'>// Enumerate Camera Roll</span></td></tr>
<tr><td class="num" id="LN165">165</td><td class="line">    [self.assetsLibrary enumerateGroupsWithTypes:ALAssetsGroupSavedPhotos usingBlock:assetsGroupsEnumerationBlock failureBlock:assetsGroupsFailureBlock];</td></tr>
<tr><td class="num" id="LN166">166</td><td class="line"> </td></tr>
<tr><td class="num" id="LN167">167</td><td class="line">    <span class='comment'>// Photo Stream</span></td></tr>
<tr><td class="num" id="LN168">168</td><td class="line">    [self.assetsLibrary enumerateGroupsWithTypes:ALAssetsGroupPhotoStream usingBlock:assetsGroupsEnumerationBlock failureBlock:assetsGroupsFailureBlock];</td></tr>
<tr><td class="num" id="LN169">169</td><td class="line"> </td></tr>
<tr><td class="num" id="LN170">170</td><td class="line">    <span class='comment'>// Album</span></td></tr>
<tr><td class="num" id="LN171">171</td><td class="line">    [self.assetsLibrary enumerateGroupsWithTypes:ALAssetsGroupAlbum usingBlock:assetsGroupsEnumerationBlock failureBlock:assetsGroupsFailureBlock];</td></tr>
<tr><td class="num" id="LN172">172</td><td class="line"> </td></tr>
<tr><td class="num" id="LN173">173</td><td class="line">    <span class='comment'>// Event</span></td></tr>
<tr><td class="num" id="LN174">174</td><td class="line">    [self.assetsLibrary enumerateGroupsWithTypes:ALAssetsGroupEvent usingBlock:assetsGroupsEnumerationBlock failureBlock:assetsGroupsFailureBlock];</td></tr>
<tr><td class="num" id="LN175">175</td><td class="line"> </td></tr>
<tr><td class="num" id="LN176">176</td><td class="line">    <span class='comment'>// Faces</span></td></tr>
<tr><td class="num" id="LN177">177</td><td class="line">    [self.assetsLibrary enumerateGroupsWithTypes:ALAssetsGroupFaces usingBlock:assetsGroupsEnumerationBlock failureBlock:assetsGroupsFailureBlock];</td></tr>
<tr><td class="num" id="LN178">178</td><td class="line"> </td></tr>
<tr><td class="num" id="LN179">179</td><td class="line">    <span class='comment'>// library</span></td></tr>
<tr><td class="num" id="LN180">180</td><td class="line">    [self.assetsLibrary enumerateGroupsWithTypes:ALAssetsGroupLibrary usingBlock:assetsGroupsEnumerationBlock failureBlock:assetsGroupsFailureBlock];</td></tr>
<tr><td class="num" id="LN181">181</td><td class="line"> </td></tr>
<tr><td class="num" id="LN182">182</td><td class="line">    <span class='comment'>// all</span></td></tr>
<tr><td class="num" id="LN183">183</td><td class="line"><span class='comment'>//    [self.assetsLibrary enumerateGroupsWithTypes:ALAssetsGroupAll usingBlock:assetsGroupsEnumerationBlock failureBlock:assetsGroupsFailureBlock];</span></td></tr>
<tr><td class="num" id="LN184">184</td><td class="line">}</td></tr>
<tr><td class="num" id="LN185">185</td><td class="line"> </td></tr>
<tr><td class="num" id="LN186">186</td><td class="line">- (<span class='keyword'>void</span>)viewWillAppear:(BOOL)animated</td></tr>
<tr><td class="num" id="LN187">187</td><td class="line">{</td></tr>
<tr><td class="num" id="LN188">188</td><td class="line">    [super viewWillAppear:animated];</td></tr>
<tr><td class="num" id="LN189">189</td><td class="line"> </td></tr>
<tr><td class="num" id="LN190">190</td><td class="line"> </td></tr>
<tr><td class="num" id="LN191">191</td><td class="line"> </td></tr>
<tr><td class="num" id="LN192">192</td><td class="line">    <span class='comment'>// 隐藏导航栏</span></td></tr>
<tr><td class="num" id="LN193">193</td><td class="line">    [[self navigationController] setNavigationBarHidden:<span class='macro'>YES<span class='expansion'>__objc_yes</span></span> animated:animated];</td></tr>
<tr><td class="num" id="LN194">194</td><td class="line">    </td></tr>
<tr><td class="num" id="LN195">195</td><td class="line">    <span class='comment'>// Full screen layout</span></td></tr>
<tr><td class="num" id="LN196">196</td><td class="line">    <span class='keyword'>if</span> (self.fullScreenLayoutEnabled) {</td></tr>
<tr><td class="num" id="LN197">197</td><td class="line">        NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];</td></tr>
<tr><td class="num" id="LN198">198</td><td class="line">        </td></tr>
<tr><td class="num" id="LN199">199</td><td class="line">        <span class='keyword'>if</span> (indexPath == <span class='macro'>nil<span class='expansion'>((void *)0)</span></span>) {</td></tr>
<tr><td class="num" id="LN200">200</td><td class="line">            self.previousBarStyle = self.navigationController.navigationBar.barStyle;</td></tr>
<tr><td class="num" id="LN201">201</td><td class="line">            self.previousBarStyle = UIBarStyleDefault;</td></tr>
<tr><td class="num" id="LN202">202</td><td class="line">            self.previousBarTranslucent = self.navigationController.navigationBar.translucent;</td></tr>
<tr><td class="num" id="LN203">203</td><td class="line">            self.previousStatusBarStyle = [[UIApplication sharedApplication] statusBarStyle];</td></tr>
<tr><td class="num" id="LN204">204</td><td class="line">            </td></tr>
<tr><td class="num" id="LN205">205</td><td class="line">            self.navigationController.navigationBar.barStyle = UIBarStyleBlack;</td></tr>
<tr><td class="num" id="LN206">206</td><td class="line">            self.navigationController.navigationBar.translucent = <span class='macro'>YES<span class='expansion'>__objc_yes</span></span>;</td></tr>
<tr><td class="num" id="LN207">207</td><td class="line">            [[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleBlackTranslucent animated:<span class='macro'>YES<span class='expansion'>__objc_yes</span></span>];</td></tr>
<tr><td class="num" id="LN208">208</td><td class="line">            </td></tr>
<tr><td class="num" id="LN209">209</td><td class="line">            CGFloat top = 0;</td></tr>
<tr><td class="num" id="LN210">210</td><td class="line">            <span class='keyword'>if</span> (![[UIApplication sharedApplication] isStatusBarHidden]) top = top + 20;</td></tr>
<tr><td class="num" id="LN211">211</td><td class="line">            <span class='keyword'>if</span> (!self.navigationController.navigationBarHidden) top = <span class="mrange">top + 44</span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="EndPath" class="msg msgEvent" style="margin-left:65ex">Value stored to 'top' is never read</div></td></tr>
<tr><td class="num" id="LN212">212</td><td class="line">            self.tableView.contentInset = UIEdgeInsetsMake(0, 0, 0, 0);</td></tr>
<tr><td class="num" id="LN213">213</td><td class="line">            self.tableView.scrollIndicatorInsets = UIEdgeInsetsMake(0, 0, 0, 0);</td></tr>
<tr><td class="num" id="LN214">214</td><td class="line">            </td></tr>
<tr><td class="num" id="LN215">215</td><td class="line">            [self setWantsFullScreenLayout:<span class='macro'>YES<span class='expansion'>__objc_yes</span></span>];</td></tr>
<tr><td class="num" id="LN216">216</td><td class="line">        }</td></tr>
<tr><td class="num" id="LN217">217</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN218">218</td><td class="line">    </td></tr>
<tr><td class="num" id="LN219">219</td><td class="line">    <span class='comment'>// Cancel table view selection</span></td></tr>
<tr><td class="num" id="LN220">220</td><td class="line">    [self.tableView deselectRowAtIndexPath:[self.tableView indexPathForSelectedRow] animated:<span class='macro'>YES<span class='expansion'>__objc_yes</span></span>];</td></tr>
<tr><td class="num" id="LN221">221</td><td class="line"><span class='comment'>//    [self nextView];</span></td></tr>
<tr><td class="num" id="LN222">222</td><td class="line">}</td></tr>
<tr><td class="num" id="LN223">223</td><td class="line"> </td></tr>
<tr><td class="num" id="LN224">224</td><td class="line">- (<span class='keyword'>void</span>)viewDidAppear:(BOOL)animated</td></tr>
<tr><td class="num" id="LN225">225</td><td class="line">{</td></tr>
<tr><td class="num" id="LN226">226</td><td class="line">    [super viewDidAppear:animated];</td></tr>
<tr><td class="num" id="LN227">227</td><td class="line">    </td></tr>
<tr><td class="num" id="LN228">228</td><td class="line">    <span class='comment'>// Flash scroll indicators</span></td></tr>
<tr><td class="num" id="LN229">229</td><td class="line">    [self.tableView flashScrollIndicators];</td></tr>
<tr><td class="num" id="LN230">230</td><td class="line"><span class='comment'>//    [self nextView];</span></td></tr>
<tr><td class="num" id="LN231">231</td><td class="line">}</td></tr>
<tr><td class="num" id="LN232">232</td><td class="line"> </td></tr>
<tr><td class="num" id="LN233">233</td><td class="line">- (<span class='keyword'>void</span>)viewWillDisappear:(BOOL)animated</td></tr>
<tr><td class="num" id="LN234">234</td><td class="line">{</td></tr>
<tr><td class="num" id="LN235">235</td><td class="line">    [super viewWillDisappear:animated];</td></tr>
<tr><td class="num" id="LN236">236</td><td class="line">    </td></tr>
<tr><td class="num" id="LN237">237</td><td class="line">    <span class='keyword'>if</span> (self.fullScreenLayoutEnabled) {</td></tr>
<tr><td class="num" id="LN238">238</td><td class="line">        <span class='comment'>// Restore bar styles</span></td></tr>
<tr><td class="num" id="LN239">239</td><td class="line">        self.navigationController.navigationBar.barStyle = self.previousBarStyle;</td></tr>
<tr><td class="num" id="LN240">240</td><td class="line">        self.navigationController.navigationBar.translucent = self.previousBarTranslucent;</td></tr>
<tr><td class="num" id="LN241">241</td><td class="line">        [[UIApplication sharedApplication] setStatusBarStyle:self.previousStatusBarStyle animated:<span class='macro'>YES<span class='expansion'>__objc_yes</span></span>];</td></tr>
<tr><td class="num" id="LN242">242</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN243">243</td><td class="line">}</td></tr>
<tr><td class="num" id="LN244">244</td><td class="line"> </td></tr>
<tr><td class="num" id="LN245">245</td><td class="line">- (<span class='keyword'>void</span>)setShowsCancelButton:(BOOL)showsCancelButton</td></tr>
<tr><td class="num" id="LN246">246</td><td class="line">{</td></tr>
<tr><td class="num" id="LN247">247</td><td class="line">    _showsCancelButton = showsCancelButton;</td></tr>
<tr><td class="num" id="LN248">248</td><td class="line">    </td></tr>
<tr><td class="num" id="LN249">249</td><td class="line">    <span class='keyword'>if</span> (self.showsCancelButton) {</td></tr>
<tr><td class="num" id="LN250">250</td><td class="line">        UIBarButtonItem *cancelButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemCancel target:self action:@selector(cancel)];</td></tr>
<tr><td class="num" id="LN251">251</td><td class="line">        [self.navigationItem setRightBarButtonItem:cancelButton animated:<span class='macro'>NO<span class='expansion'>__objc_no</span></span>];</td></tr>
<tr><td class="num" id="LN252">252</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr><td class="num" id="LN253">253</td><td class="line">        [self.navigationItem setRightBarButtonItem:<span class='macro'>nil<span class='expansion'>((void *)0)</span></span> animated:<span class='macro'>NO<span class='expansion'>__objc_no</span></span>];</td></tr>
<tr><td class="num" id="LN254">254</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN255">255</td><td class="line">}</td></tr>
<tr><td class="num" id="LN256">256</td><td class="line"> </td></tr>
<tr><td class="num" id="LN257">257</td><td class="line"> </td></tr>
<tr><td class="num" id="LN258">258</td><td class="line"><span class='directive'>#pragma mark - Instance Methods</span></td></tr>
<tr><td class="num" id="LN259">259</td><td class="line"> </td></tr>
<tr><td class="num" id="LN260">260</td><td class="line">- (<span class='keyword'>void</span>)cancel</td></tr>
<tr><td class="num" id="LN261">261</td><td class="line">{</td></tr>
<tr><td class="num" id="LN262">262</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(imagePickerControllerDidCancel:)]) {</td></tr>
<tr><td class="num" id="LN263">263</td><td class="line">        [self.delegate imagePickerControllerDidCancel:self];</td></tr>
<tr><td class="num" id="LN264">264</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN265">265</td><td class="line">}</td></tr>
<tr><td class="num" id="LN266">266</td><td class="line"> </td></tr>
<tr><td class="num" id="LN267">267</td><td class="line">- (NSDictionary *)mediaInfoFromAsset:(ALAsset *)asset</td></tr>
<tr><td class="num" id="LN268">268</td><td class="line">{</td></tr>
<tr><td class="num" id="LN269">269</td><td class="line">    NSMutableDictionary *mediaInfo = [NSMutableDictionary dictionary];</td></tr>
<tr><td class="num" id="LN270">270</td><td class="line"> </td></tr>
<tr><td class="num" id="LN271">271</td><td class="line">    [mediaInfo setObject:[asset valueForProperty:ALAssetPropertyType] forKey:@<span class='string_literal'>"UIImagePickerControllerMediaType"</span>];</td></tr>
<tr><td class="num" id="LN272">272</td><td class="line">    <span class='keyword'>if</span> ([UIImage imageWithCGImage:[[asset defaultRepresentation] fullScreenImage]])</td></tr>
<tr><td class="num" id="LN273">273</td><td class="line">    {</td></tr>
<tr><td class="num" id="LN274">274</td><td class="line">        [mediaInfo setObject:[UIImage imageWithCGImage:[[asset defaultRepresentation] fullScreenImage]] forKey:@<span class='string_literal'>"UIImagePickerControllerOriginalImage"</span>];</td></tr>
<tr><td class="num" id="LN275">275</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN276">276</td><td class="line">    [mediaInfo setObject:[[asset valueForProperty:ALAssetPropertyURLs] valueForKey:[[[asset valueForProperty:ALAssetPropertyURLs] allKeys] objectAtIndex:0]] forKey:@<span class='string_literal'>"UIImagePickerControllerReferenceURL"</span>];</td></tr>
<tr><td class="num" id="LN277">277</td><td class="line">    </td></tr>
<tr><td class="num" id="LN278">278</td><td class="line">    <span class='keyword'>return</span> mediaInfo;</td></tr>
<tr><td class="num" id="LN279">279</td><td class="line">}</td></tr>
<tr><td class="num" id="LN280">280</td><td class="line"> </td></tr>
<tr><td class="num" id="LN281">281</td><td class="line"> </td></tr>
<tr><td class="num" id="LN282">282</td><td class="line"><span class='directive'>#pragma mark - UITableViewDataSource</span></td></tr>
<tr><td class="num" id="LN283">283</td><td class="line"> </td></tr>
<tr><td class="num" id="LN284">284</td><td class="line">- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView</td></tr>
<tr><td class="num" id="LN285">285</td><td class="line">{</td></tr>
<tr><td class="num" id="LN286">286</td><td class="line">    <span class='keyword'>return</span> 1;</td></tr>
<tr><td class="num" id="LN287">287</td><td class="line">}</td></tr>
<tr><td class="num" id="LN288">288</td><td class="line"> </td></tr>
<tr><td class="num" id="LN289">289</td><td class="line">- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section</td></tr>
<tr><td class="num" id="LN290">290</td><td class="line">{</td></tr>
<tr><td class="num" id="LN291">291</td><td class="line">    <span class='keyword'>return</span> self.assetsGroups.count;</td></tr>
<tr><td class="num" id="LN292">292</td><td class="line">}</td></tr>
<tr><td class="num" id="LN293">293</td><td class="line"> </td></tr>
<tr><td class="num" id="LN294">294</td><td class="line">- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath</td></tr>
<tr><td class="num" id="LN295">295</td><td class="line">{</td></tr>
<tr><td class="num" id="LN296">296</td><td class="line">    <span class='keyword'>static</span> NSString *cellIdentifier = @<span class='string_literal'>"Cell"</span>;</td></tr>
<tr><td class="num" id="LN297">297</td><td class="line">    QBImagePickerGroupCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];</td></tr>
<tr><td class="num" id="LN298">298</td><td class="line">    </td></tr>
<tr><td class="num" id="LN299">299</td><td class="line">    <span class='keyword'>if</span> (cell == <span class='macro'>nil<span class='expansion'>((void *)0)</span></span>) {</td></tr>
<tr><td class="num" id="LN300">300</td><td class="line">        cell = [[QBImagePickerGroupCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];</td></tr>
<tr><td class="num" id="LN301">301</td><td class="line">        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;</td></tr>
<tr><td class="num" id="LN302">302</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN303">303</td><td class="line">    </td></tr>
<tr><td class="num" id="LN304">304</td><td class="line">    ALAssetsGroup *assetsGroup = [self.assetsGroups objectAtIndex:indexPath.row];</td></tr>
<tr><td class="num" id="LN305">305</td><td class="line">    </td></tr>
<tr><td class="num" id="LN306">306</td><td class="line">    cell.image.image = [UIImage imageWithCGImage:assetsGroup.posterImage];</td></tr>
<tr><td class="num" id="LN307">307</td><td class="line">    cell.titleLabel.text = [NSString stringWithFormat:@<span class='string_literal'>"%@"</span>, [assetsGroup valueForProperty:ALAssetsGroupPropertyName]];</td></tr>
<tr><td class="num" id="LN308">308</td><td class="line">    cell.countLabel.text = [NSString stringWithFormat:@<span class='string_literal'>"(%@)"</span>, @(assetsGroup.numberOfAssets).stringValue];</td></tr>
<tr><td class="num" id="LN309">309</td><td class="line">    </td></tr>
<tr><td class="num" id="LN310">310</td><td class="line">    <span class='keyword'>return</span> cell;</td></tr>
<tr><td class="num" id="LN311">311</td><td class="line">}</td></tr>
<tr><td class="num" id="LN312">312</td><td class="line"> </td></tr>
<tr><td class="num" id="LN313">313</td><td class="line"> </td></tr>
<tr><td class="num" id="LN314">314</td><td class="line"><span class='directive'>#pragma mark - UITableViewDelegate</span></td></tr>
<tr><td class="num" id="LN315">315</td><td class="line"> </td></tr>
<tr><td class="num" id="LN316">316</td><td class="line">- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath</td></tr>
<tr><td class="num" id="LN317">317</td><td class="line">{</td></tr>
<tr><td class="num" id="LN318">318</td><td class="line">    <span class='keyword'>return</span> 60;</td></tr>
<tr><td class="num" id="LN319">319</td><td class="line">}</td></tr>
<tr><td class="num" id="LN320">320</td><td class="line"> </td></tr>
<tr><td class="num" id="LN321">321</td><td class="line">- (<span class='keyword'>void</span>)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath</td></tr>
<tr><td class="num" id="LN322">322</td><td class="line">{</td></tr>
<tr><td class="num" id="LN323">323</td><td class="line">    ALAssetsGroup *assetsGroup = [self.assetsGroups objectAtIndex:indexPath.row];</td></tr>
<tr><td class="num" id="LN324">324</td><td class="line">    </td></tr>
<tr><td class="num" id="LN325">325</td><td class="line">    BOOL showsHeaderButton = ([self.delegate respondsToSelector:@selector(descriptionForSelectingAllAssets:)] &amp;&amp; [self.delegate respondsToSelector:@selector(descriptionForDeselectingAllAssets:)]);</td></tr>
<tr><td class="num" id="LN326">326</td><td class="line">    </td></tr>
<tr><td class="num" id="LN327">327</td><td class="line">    BOOL showsFooterDescription = <span class='macro'>NO<span class='expansion'>__objc_no</span></span>;</td></tr>
<tr><td class="num" id="LN328">328</td><td class="line">    </td></tr>
<tr><td class="num" id="LN329">329</td><td class="line">    <span class='keyword'>switch</span>(self.filterType) {</td></tr>
<tr><td class="num" id="LN330">330</td><td class="line">        <span class='keyword'>case</span> QBImagePickerFilterTypeAllAssets:</td></tr>
<tr><td class="num" id="LN331">331</td><td class="line">            showsFooterDescription = ([self.delegate respondsToSelector:@selector(imagePickerController:descriptionForNumberOfPhotos:numberOfVideos:)]);</td></tr>
<tr><td class="num" id="LN332">332</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr><td class="num" id="LN333">333</td><td class="line">        <span class='keyword'>case</span> QBImagePickerFilterTypeAllPhotos:</td></tr>
<tr><td class="num" id="LN334">334</td><td class="line">            showsFooterDescription = ([self.delegate respondsToSelector:@selector(imagePickerController:descriptionForNumberOfPhotos:)]);</td></tr>
<tr><td class="num" id="LN335">335</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr><td class="num" id="LN336">336</td><td class="line">        <span class='keyword'>case</span> QBImagePickerFilterTypeAllVideos:</td></tr>
<tr><td class="num" id="LN337">337</td><td class="line">            showsFooterDescription = ([self.delegate respondsToSelector:@selector(imagePickerController:descriptionForNumberOfVideos:)]);</td></tr>
<tr><td class="num" id="LN338">338</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr><td class="num" id="LN339">339</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN340">340</td><td class="line">    </td></tr>
<tr><td class="num" id="LN341">341</td><td class="line">    <span class='comment'>// Show assets collection view</span></td></tr>
<tr><td class="num" id="LN342">342</td><td class="line">    QBAssetCollectionViewController *assetCollectionViewController = [[QBAssetCollectionViewController alloc] init];</td></tr>
<tr><td class="num" id="LN343">343</td><td class="line">    assetCollectionViewController.title = [assetsGroup valueForProperty:ALAssetsGroupPropertyName];</td></tr>
<tr><td class="num" id="LN344">344</td><td class="line">    assetCollectionViewController.delegate = self;</td></tr>
<tr><td class="num" id="LN345">345</td><td class="line">    assetCollectionViewController.assetsGroup = assetsGroup;</td></tr>
<tr><td class="num" id="LN346">346</td><td class="line">    assetCollectionViewController.filterType = self.filterType;</td></tr>
<tr><td class="num" id="LN347">347</td><td class="line">    assetCollectionViewController.showsCancelButton = self.showsCancelButton;</td></tr>
<tr><td class="num" id="LN348">348</td><td class="line">    assetCollectionViewController.fullScreenLayoutEnabled = self.fullScreenLayoutEnabled;</td></tr>
<tr><td class="num" id="LN349">349</td><td class="line">    assetCollectionViewController.showsHeaderButton = showsHeaderButton;</td></tr>
<tr><td class="num" id="LN350">350</td><td class="line">    assetCollectionViewController.showsFooterDescription = showsFooterDescription;</td></tr>
<tr><td class="num" id="LN351">351</td><td class="line">    </td></tr>
<tr><td class="num" id="LN352">352</td><td class="line">    assetCollectionViewController.allowsMultipleSelection = self.allowsMultipleSelection;</td></tr>
<tr><td class="num" id="LN353">353</td><td class="line">    assetCollectionViewController.limitsMinimumNumberOfSelection = self.limitsMinimumNumberOfSelection;</td></tr>
<tr><td class="num" id="LN354">354</td><td class="line">    assetCollectionViewController.limitsMaximumNumberOfSelection = self.limitsMaximumNumberOfSelection;</td></tr>
<tr><td class="num" id="LN355">355</td><td class="line">    assetCollectionViewController.minimumNumberOfSelection = self.minimumNumberOfSelection;</td></tr>
<tr><td class="num" id="LN356">356</td><td class="line">    assetCollectionViewController.maximumNumberOfSelection = self.maximumNumberOfSelection;</td></tr>
<tr><td class="num" id="LN357">357</td><td class="line">    </td></tr>
<tr><td class="num" id="LN358">358</td><td class="line">    [self.navigationController pushViewController:assetCollectionViewController animated:<span class='macro'>NO<span class='expansion'>__objc_no</span></span>];</td></tr>
<tr><td class="num" id="LN359">359</td><td class="line">}</td></tr>
<tr><td class="num" id="LN360">360</td><td class="line"> </td></tr>
<tr><td class="num" id="LN361">361</td><td class="line"> </td></tr>
<tr><td class="num" id="LN362">362</td><td class="line">-(<span class='keyword'>void</span>)nextView {</td></tr>
<tr><td class="num" id="LN363">363</td><td class="line">    ALAssetsGroup *assetsGroup = [self.assetsGroups objectAtIndex:0];</td></tr>
<tr><td class="num" id="LN364">364</td><td class="line">    </td></tr>
<tr><td class="num" id="LN365">365</td><td class="line">    BOOL showsHeaderButton = ([self.delegate respondsToSelector:@selector(descriptionForSelectingAllAssets:)] &amp;&amp; [self.delegate respondsToSelector:@selector(descriptionForDeselectingAllAssets:)]);</td></tr>
<tr><td class="num" id="LN366">366</td><td class="line">    </td></tr>
<tr><td class="num" id="LN367">367</td><td class="line">    BOOL showsFooterDescription = <span class='macro'>NO<span class='expansion'>__objc_no</span></span>;</td></tr>
<tr><td class="num" id="LN368">368</td><td class="line">    </td></tr>
<tr><td class="num" id="LN369">369</td><td class="line">    <span class='keyword'>switch</span>(self.filterType) {</td></tr>
<tr><td class="num" id="LN370">370</td><td class="line">        <span class='keyword'>case</span> QBImagePickerFilterTypeAllAssets:</td></tr>
<tr><td class="num" id="LN371">371</td><td class="line">            showsFooterDescription = ([self.delegate respondsToSelector:@selector(imagePickerController:descriptionForNumberOfPhotos:numberOfVideos:)]);</td></tr>
<tr><td class="num" id="LN372">372</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr><td class="num" id="LN373">373</td><td class="line">        <span class='keyword'>case</span> QBImagePickerFilterTypeAllPhotos:</td></tr>
<tr><td class="num" id="LN374">374</td><td class="line">            showsFooterDescription = ([self.delegate respondsToSelector:@selector(imagePickerController:descriptionForNumberOfPhotos:)]);</td></tr>
<tr><td class="num" id="LN375">375</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr><td class="num" id="LN376">376</td><td class="line">        <span class='keyword'>case</span> QBImagePickerFilterTypeAllVideos:</td></tr>
<tr><td class="num" id="LN377">377</td><td class="line">            showsFooterDescription = ([self.delegate respondsToSelector:@selector(imagePickerController:descriptionForNumberOfVideos:)]);</td></tr>
<tr><td class="num" id="LN378">378</td><td class="line">            <span class='keyword'>break</span>;</td></tr>
<tr><td class="num" id="LN379">379</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN380">380</td><td class="line">    </td></tr>
<tr><td class="num" id="LN381">381</td><td class="line">    <span class='comment'>// Show assets collection view</span></td></tr>
<tr><td class="num" id="LN382">382</td><td class="line">    QBAssetCollectionViewController *assetCollectionViewController = [[QBAssetCollectionViewController alloc] init];</td></tr>
<tr><td class="num" id="LN383">383</td><td class="line">    assetCollectionViewController.title = [assetsGroup valueForProperty:ALAssetsGroupPropertyName];</td></tr>
<tr><td class="num" id="LN384">384</td><td class="line">    assetCollectionViewController.delegate = self;</td></tr>
<tr><td class="num" id="LN385">385</td><td class="line">    assetCollectionViewController.assetsGroup = assetsGroup;</td></tr>
<tr><td class="num" id="LN386">386</td><td class="line">    assetCollectionViewController.filterType = self.filterType;</td></tr>
<tr><td class="num" id="LN387">387</td><td class="line">    assetCollectionViewController.showsCancelButton = self.showsCancelButton;</td></tr>
<tr><td class="num" id="LN388">388</td><td class="line">    assetCollectionViewController.fullScreenLayoutEnabled = self.fullScreenLayoutEnabled;</td></tr>
<tr><td class="num" id="LN389">389</td><td class="line">    assetCollectionViewController.showsHeaderButton = showsHeaderButton;</td></tr>
<tr><td class="num" id="LN390">390</td><td class="line">    assetCollectionViewController.showsFooterDescription = showsFooterDescription;</td></tr>
<tr><td class="num" id="LN391">391</td><td class="line">    </td></tr>
<tr><td class="num" id="LN392">392</td><td class="line">    assetCollectionViewController.allowsMultipleSelection = self.allowsMultipleSelection;</td></tr>
<tr><td class="num" id="LN393">393</td><td class="line">    assetCollectionViewController.limitsMinimumNumberOfSelection = self.limitsMinimumNumberOfSelection;</td></tr>
<tr><td class="num" id="LN394">394</td><td class="line">    assetCollectionViewController.limitsMaximumNumberOfSelection = self.limitsMaximumNumberOfSelection;</td></tr>
<tr><td class="num" id="LN395">395</td><td class="line">    assetCollectionViewController.minimumNumberOfSelection = self.minimumNumberOfSelection;</td></tr>
<tr><td class="num" id="LN396">396</td><td class="line">    assetCollectionViewController.maximumNumberOfSelection = self.maximumNumberOfSelection;</td></tr>
<tr><td class="num" id="LN397">397</td><td class="line">    </td></tr>
<tr><td class="num" id="LN398">398</td><td class="line"><span class='comment'>//    [self.navigationController pushViewController:assetCollectionViewController animated:YES];</span></td></tr>
<tr><td class="num" id="LN399">399</td><td class="line">}</td></tr>
<tr><td class="num" id="LN400">400</td><td class="line"> </td></tr>
<tr><td class="num" id="LN401">401</td><td class="line"> </td></tr>
<tr><td class="num" id="LN402">402</td><td class="line"><span class='directive'>#pragma mark - QBAssetCollectionViewControllerDelegate</span></td></tr>
<tr><td class="num" id="LN403">403</td><td class="line"> </td></tr>
<tr><td class="num" id="LN404">404</td><td class="line">- (<span class='keyword'>void</span>)assetCollectionViewController:(QBAssetCollectionViewController *)assetCollectionViewController didFinishPickingAsset:(ALAsset *)asset</td></tr>
<tr><td class="num" id="LN405">405</td><td class="line">{</td></tr>
<tr><td class="num" id="LN406">406</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(imagePickerControllerWillFinishPickingMedia:)]) {</td></tr>
<tr><td class="num" id="LN407">407</td><td class="line">        [self.delegate imagePickerControllerWillFinishPickingMedia:self];</td></tr>
<tr><td class="num" id="LN408">408</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN409">409</td><td class="line">    </td></tr>
<tr><td class="num" id="LN410">410</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(imagePickerController:didFinishPickingMediaWithInfo:)]) {</td></tr>
<tr><td class="num" id="LN411">411</td><td class="line">        [self.delegate imagePickerController:self didFinishPickingMediaWithInfo:[self mediaInfoFromAsset:asset]];</td></tr>
<tr><td class="num" id="LN412">412</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN413">413</td><td class="line">}</td></tr>
<tr><td class="num" id="LN414">414</td><td class="line"> </td></tr>
<tr><td class="num" id="LN415">415</td><td class="line">- (<span class='keyword'>void</span>)assetCollectionViewController:(QBAssetCollectionViewController *)assetCollectionViewController didFinishPickingAssets:(NSArray *)assets</td></tr>
<tr><td class="num" id="LN416">416</td><td class="line">{</td></tr>
<tr><td class="num" id="LN417">417</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(imagePickerControllerWillFinishPickingMedia:)]) {</td></tr>
<tr><td class="num" id="LN418">418</td><td class="line">        [self.delegate imagePickerControllerWillFinishPickingMedia:self];</td></tr>
<tr><td class="num" id="LN419">419</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN420">420</td><td class="line">    </td></tr>
<tr><td class="num" id="LN421">421</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(imagePickerController:didFinishPickingMediaWithInfo:)]) {</td></tr>
<tr><td class="num" id="LN422">422</td><td class="line">        NSMutableArray *info = [NSMutableArray array];</td></tr>
<tr><td class="num" id="LN423">423</td><td class="line">        </td></tr>
<tr><td class="num" id="LN424">424</td><td class="line">        <span class='keyword'>for</span> (ALAsset *asset in assets) {</td></tr>
<tr><td class="num" id="LN425">425</td><td class="line">            [info addObject:[self mediaInfoFromAsset:asset]];</td></tr>
<tr><td class="num" id="LN426">426</td><td class="line">        }</td></tr>
<tr><td class="num" id="LN427">427</td><td class="line">        </td></tr>
<tr><td class="num" id="LN428">428</td><td class="line">        [self.delegate imagePickerController:self didFinishPickingMediaWithInfo:info];</td></tr>
<tr><td class="num" id="LN429">429</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN430">430</td><td class="line">}</td></tr>
<tr><td class="num" id="LN431">431</td><td class="line"> </td></tr>
<tr><td class="num" id="LN432">432</td><td class="line">- (<span class='keyword'>void</span>)assetCollectionViewControllerDidCancel:(QBAssetCollectionViewController *)assetCollectionViewController</td></tr>
<tr><td class="num" id="LN433">433</td><td class="line">{</td></tr>
<tr><td class="num" id="LN434">434</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(imagePickerControllerDidCancel:)]) {</td></tr>
<tr><td class="num" id="LN435">435</td><td class="line">        [self.delegate imagePickerControllerDidCancel:self];</td></tr>
<tr><td class="num" id="LN436">436</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN437">437</td><td class="line">}</td></tr>
<tr><td class="num" id="LN438">438</td><td class="line"> </td></tr>
<tr><td class="num" id="LN439">439</td><td class="line">- (NSString *)descriptionForSelectingAllAssets:(QBAssetCollectionViewController *)assetCollectionViewController</td></tr>
<tr><td class="num" id="LN440">440</td><td class="line">{</td></tr>
<tr><td class="num" id="LN441">441</td><td class="line">    NSString *description = <span class='macro'>nil<span class='expansion'>((void *)0)</span></span>;</td></tr>
<tr><td class="num" id="LN442">442</td><td class="line">    </td></tr>
<tr><td class="num" id="LN443">443</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(descriptionForSelectingAllAssets:)]) {</td></tr>
<tr><td class="num" id="LN444">444</td><td class="line">        description = [self.delegate descriptionForSelectingAllAssets:self];</td></tr>
<tr><td class="num" id="LN445">445</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN446">446</td><td class="line">    </td></tr>
<tr><td class="num" id="LN447">447</td><td class="line">    <span class='keyword'>return</span> description;</td></tr>
<tr><td class="num" id="LN448">448</td><td class="line">}</td></tr>
<tr><td class="num" id="LN449">449</td><td class="line"> </td></tr>
<tr><td class="num" id="LN450">450</td><td class="line">- (NSString *)descriptionForDeselectingAllAssets:(QBAssetCollectionViewController *)assetCollectionViewController</td></tr>
<tr><td class="num" id="LN451">451</td><td class="line">{</td></tr>
<tr><td class="num" id="LN452">452</td><td class="line">    NSString *description = <span class='macro'>nil<span class='expansion'>((void *)0)</span></span>;</td></tr>
<tr><td class="num" id="LN453">453</td><td class="line">    </td></tr>
<tr><td class="num" id="LN454">454</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(descriptionForDeselectingAllAssets:)]) {</td></tr>
<tr><td class="num" id="LN455">455</td><td class="line">        description = [self.delegate descriptionForDeselectingAllAssets:self];</td></tr>
<tr><td class="num" id="LN456">456</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN457">457</td><td class="line">    </td></tr>
<tr><td class="num" id="LN458">458</td><td class="line">    <span class='keyword'>return</span> description;</td></tr>
<tr><td class="num" id="LN459">459</td><td class="line">}</td></tr>
<tr><td class="num" id="LN460">460</td><td class="line"> </td></tr>
<tr><td class="num" id="LN461">461</td><td class="line">- (NSString *)assetCollectionViewController:(QBAssetCollectionViewController *)assetCollectionViewController descriptionForNumberOfPhotos:(NSUInteger)numberOfPhotos</td></tr>
<tr><td class="num" id="LN462">462</td><td class="line">{</td></tr>
<tr><td class="num" id="LN463">463</td><td class="line">    NSString *description = <span class='macro'>nil<span class='expansion'>((void *)0)</span></span>;</td></tr>
<tr><td class="num" id="LN464">464</td><td class="line">    </td></tr>
<tr><td class="num" id="LN465">465</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(imagePickerController:descriptionForNumberOfPhotos:)]) {</td></tr>
<tr><td class="num" id="LN466">466</td><td class="line">        description = [self.delegate imagePickerController:self descriptionForNumberOfPhotos:numberOfPhotos];</td></tr>
<tr><td class="num" id="LN467">467</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN468">468</td><td class="line">    </td></tr>
<tr><td class="num" id="LN469">469</td><td class="line">    <span class='keyword'>return</span> description;</td></tr>
<tr><td class="num" id="LN470">470</td><td class="line">}</td></tr>
<tr><td class="num" id="LN471">471</td><td class="line"> </td></tr>
<tr><td class="num" id="LN472">472</td><td class="line">- (NSString *)assetCollectionViewController:(QBAssetCollectionViewController *)assetCollectionViewController descriptionForNumberOfVideos:(NSUInteger)numberOfVideos</td></tr>
<tr><td class="num" id="LN473">473</td><td class="line">{</td></tr>
<tr><td class="num" id="LN474">474</td><td class="line">    NSString *description = <span class='macro'>nil<span class='expansion'>((void *)0)</span></span>;</td></tr>
<tr><td class="num" id="LN475">475</td><td class="line">    </td></tr>
<tr><td class="num" id="LN476">476</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(imagePickerController:descriptionForNumberOfVideos:)]) {</td></tr>
<tr><td class="num" id="LN477">477</td><td class="line">        description = [self.delegate imagePickerController:self descriptionForNumberOfVideos:numberOfVideos];</td></tr>
<tr><td class="num" id="LN478">478</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN479">479</td><td class="line">    </td></tr>
<tr><td class="num" id="LN480">480</td><td class="line">    <span class='keyword'>return</span> description;</td></tr>
<tr><td class="num" id="LN481">481</td><td class="line">}</td></tr>
<tr><td class="num" id="LN482">482</td><td class="line"> </td></tr>
<tr><td class="num" id="LN483">483</td><td class="line">- (NSString *)assetCollectionViewController:(QBAssetCollectionViewController *)assetCollectionViewController descriptionForNumberOfPhotos:(NSUInteger)numberOfPhotos numberOfVideos:(NSUInteger)numberOfVideos</td></tr>
<tr><td class="num" id="LN484">484</td><td class="line">{</td></tr>
<tr><td class="num" id="LN485">485</td><td class="line">    NSString *description = <span class='macro'>nil<span class='expansion'>((void *)0)</span></span>;</td></tr>
<tr><td class="num" id="LN486">486</td><td class="line">    </td></tr>
<tr><td class="num" id="LN487">487</td><td class="line">    <span class='keyword'>if</span> ([self.delegate respondsToSelector:@selector(imagePickerController:descriptionForNumberOfPhotos:numberOfVideos:)]) {</td></tr>
<tr><td class="num" id="LN488">488</td><td class="line">        description = [self.delegate imagePickerController:self descriptionForNumberOfPhotos:numberOfPhotos numberOfVideos:numberOfVideos];</td></tr>
<tr><td class="num" id="LN489">489</td><td class="line">    }</td></tr>
<tr><td class="num" id="LN490">490</td><td class="line">    </td></tr>
<tr><td class="num" id="LN491">491</td><td class="line">    <span class='keyword'>return</span> description;</td></tr>
<tr><td class="num" id="LN492">492</td><td class="line">}</td></tr>
<tr><td class="num" id="LN493">493</td><td class="line"> </td></tr>
<tr><td class="num" id="LN494">494</td><td class="line"><span class='directive'>#pragma mark -</span></td></tr>
<tr><td class="num" id="LN495">495</td><td class="line"><span class='directive'>#pragma mark BackButtonDelegate</span></td></tr>
<tr><td class="num" id="LN496">496</td><td class="line">- (<span class='keyword'>void</span>)backButtonPressed {</td></tr>
<tr><td class="num" id="LN497">497</td><td class="line"> </td></tr>
<tr><td class="num" id="LN498">498</td><td class="line"><span class='comment'>//    [self dismissModalViewControllerAnimated:NO];</span></td></tr>
<tr><td class="num" id="LN499">499</td><td class="line">}</td></tr>
<tr><td class="num" id="LN500">500</td><td class="line"> </td></tr>
<tr><td class="num" id="LN501">501</td><td class="line">- (<span class='keyword'>void</span>)camera:(UIImage *)img {</td></tr>
<tr><td class="num" id="LN502">502</td><td class="line">    NSLog(@<span class='string_literal'>"camera:imag"</span>);</td></tr>
<tr><td class="num" id="LN503">503</td><td class="line">    [self.delegate cameraImage:img];</td></tr>
<tr><td class="num" id="LN504">504</td><td class="line">}</td></tr>
<tr><td class="num" id="LN505">505</td><td class="line"> </td></tr>
<tr><td class="num" id="LN506">506</td><td class="line"> </td></tr>
<tr><td class="num" id="LN507">507</td><td class="line">- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation</td></tr>
<tr><td class="num" id="LN508">508</td><td class="line">{</td></tr>
<tr><td class="num" id="LN509">509</td><td class="line">    <span class='keyword'>return</span> (toInterfaceOrientation == UIInterfaceOrientationPortrait);</td></tr>
<tr><td class="num" id="LN510">510</td><td class="line">}</td></tr>
<tr><td class="num" id="LN511">511</td><td class="line"> </td></tr>
<tr><td class="num" id="LN512">512</td><td class="line">- (NSUInteger)supportedInterfaceOrientations</td></tr>
<tr><td class="num" id="LN513">513</td><td class="line">{</td></tr>
<tr><td class="num" id="LN514">514</td><td class="line">    <span class='keyword'>return</span> UIInterfaceOrientationMaskPortrait;</td></tr>
<tr><td class="num" id="LN515">515</td><td class="line">}</td></tr>
<tr><td class="num" id="LN516">516</td><td class="line"> </td></tr>
<tr><td class="num" id="LN517">517</td><td class="line">- (BOOL)shouldAutorotate</td></tr>
<tr><td class="num" id="LN518">518</td><td class="line">{</td></tr>
<tr><td class="num" id="LN519">519</td><td class="line">    <span class='keyword'>return</span> <span class='macro'>NO<span class='expansion'>__objc_no</span></span>;</td></tr>
<tr><td class="num" id="LN520">520</td><td class="line">}</td></tr>
<tr><td class="num" id="LN521">521</td><td class="line"> </td></tr>
<tr><td class="num" id="LN522">522</td><td class="line">- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation</td></tr>
<tr><td class="num" id="LN523">523</td><td class="line">{</td></tr>
<tr><td class="num" id="LN524">524</td><td class="line">    <span class='keyword'>return</span> UIInterfaceOrientationPortrait;</td></tr>
<tr><td class="num" id="LN525">525</td><td class="line">}</td></tr>
<tr><td class="num" id="LN526">526</td><td class="line">@end</td></tr>
</table></body></html>
